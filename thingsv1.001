# Pefile install and import malware to analyze
# should be in the path
$ pip install pefile
$ python
$ import pefile
$ pe = pefile.PE("malware_name.exe")

# Case 1. .exe in .ico
# Directory to save the images
$ mkdir images
# extract -x into /images
# download wrestool+icontool in here: http://www.nongnu.org/icoutils/
$ wrestool -x (malware_name).exe -output=images
# extract and convert the .icon into .png
$ icotool -x -o images images/*.ico

# Case 2. Strings
$ strings filepath|less 
$ strings -n (number of bytes at least) filepath
#example
$ strings malware.exe > malware.txt

# Pefile and capstone disassembling
# This will print the malware operations in assembly code
$ pip install pefile
$ pip install capstone
#!/usr/bin/python
import pefile
from capstone import*
pe = pefile.PE("malware_name.exe")
entrypoint = pe.OPTIONAL_HEADER.AddressOfEntryPoint
entrypoint_address = entrypoint+pe.OPTIONAL_HEADER.ImageBase
binary_code = pe.get_memory_mapped_image()[entrypoint:entrypoint+100]
disassembler = Cs(CS_ARCH_X86, CS_MODE_32)
for instruction in disassembler.disasm(binary_code, entrypoint_address):
  print"%s\t%s"%(instruction.mnemonic, instruction.op_str)

# Building networks with NetworkX \\pg70 ch4
#!usr\bin\python
import networkx
